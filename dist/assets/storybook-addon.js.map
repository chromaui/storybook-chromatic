{"version":3,"sources":["../../src/assets/storybook-addon.js"],"names":["location","pathname","match","console","error","runtime","renderSpec","specRuntime","input","window","__STORYBOOK_CLIENT_API__","__STORYBOOK_ADDONS_CHANNEL__","Error","kind","name","emit","story","document","body","classList","contains","message","getElementById","textContent","stack","specs","getStorybook","map","stories","component","displayName","split","slice","reduce","a","b"],"mappings":";;;;;;;;;;AAGA;;;;;;AAEA,IAAI,CAACA,SAASC,QAAT,CAAkBC,KAAlB,CAAwB,cAAxB,CAAL,EAA8C;AAC5CC,UAAQC,KAAR;AACD,C,CAPD;AACA;;AASA,IAAMC,UAAU,WAAhB;AACA,sBAAU;AACRA,kBADQ;AAERC,YAFQ,4BAEoC;AAAA,QAAtBC,WAAsB,QAA/BF,OAA+B;AAAA,QAATG,KAAS,QAATA,KAAS;AAAA,kBACyBC,MADzB;AAAA,QAClCC,wBADkC,WAClCA,wBADkC;AAAA,QACRC,4BADQ,WACRA,4BADQ;;;AAG1C,QAAI,CAACD,wBAAD,IAA6B,CAACC,4BAAlC,EAAgE;AAC9D,YAAM,IAAIC,KAAJ,oFAAN;AAGD;;AAED,QAAIL,gBAAgBF,OAApB,EAA6B;AAC3B,YAAM,IAAIO,KAAJ,qCAA4CL,WAA5C,YAAN;AACD;;AAXyC,QAalCM,IAbkC,GAanBL,KAbmB,CAalCK,IAbkC;AAAA,QAa5BC,IAb4B,GAanBN,KAbmB,CAa5BM,IAb4B;;AAc1CH,iCAA6BI,IAA7B,CAAkC,iBAAlC,EAAqD,EAAEF,UAAF,EAAQG,OAAOF,IAAf,EAArD;;AAEA;AACA;AACA,QAAIG,SAASC,IAAT,CAAcC,SAAd,CAAwBC,QAAxB,CAAiC,sBAAjC,CAAJ,EAA8D;AAC5D,UAAMC,UAAUJ,SAASK,cAAT,CAAwB,eAAxB,EAAyCC,WAAzD;AACA,UAAMC,QAAQP,SAASK,cAAT,CAAwB,aAAxB,EAAuCC,WAArD;AACA,UAAMnB,QAAQ,IAAIQ,KAAJ,CAAUS,OAAV,CAAd;AACAjB,YAAMoB,KAAN,GAAcA,KAAd;AACA,YAAMpB,KAAN;AACD;;AAED,WAAOa,SAASK,cAAT,CAAwB,MAAxB,CAAP;AACD,GA7BO;AA8BRG,OA9BQ,mBA8BA;AAAA,mBAC6DhB,MAD7D;AAAA,QACEC,wBADF,YACEA,wBADF;AAAA,QAC4BC,4BAD5B,YAC4BA,4BAD5B;;;AAGN,QAAI,CAACD,wBAAD,IAA6B,CAACC,4BAAlC,EAAgE;AAC9D,YAAM,IAAIC,KAAJ,oFAAN;AAGD;;AAED,WAAOF,yBACJgB,YADI,GAEJC,GAFI,CAEA;AAAA,UAAGd,IAAH,SAAGA,IAAH;AAAA,UAASe,OAAT,SAASA,OAAT;AAAA,aACHA,QAAQD,GAAR,CAAY;AAAA,YAAGb,IAAH,SAAGA,IAAH;AAAA,eAAe;AACzBA,oBADyB;AAEzBe,qBAAW;AACTf,kBAAMD,IADG;AAETiB,yBAAajB,KAAKkB,KAAL,CAAW,GAAX,EAAgBC,KAAhB,CAAsB,CAAC,CAAvB,EAA0B,CAA1B;AAFJ,WAFc;AAMzB3B,0BANyB;AAOzBG,iBAAO,yBAAe;AACpBK,sBADoB;AAEpBC;AAFoB,WAAf;AAPkB,SAAf;AAAA,OAAZ,CADG;AAAA,KAFA,EAgBJmB,MAhBI,CAgBG,UAACC,CAAD,EAAIC,CAAJ;AAAA,wDAAcD,CAAd,oCAAoBC,CAApB;AAAA,KAhBH,EAgB2B,EAhB3B,CAAP,CATM,CAyBiC;AACxC;AAxDO,CAAV","file":"storybook-addon.js","sourcesContent":["/* eslint-env browser */\n/* eslint-disable import/no-extraneous-dependencies, global-require */\n\nimport configure from '../client';\n\nif (!location.pathname.match('/iframe.html')) {\n  console.error(`storybook-chromatic should be installed in your \\`.storybook/config.js\\``);\n}\n\n\nconst runtime = 'storybook';\nconfigure({\n  runtime,\n  renderSpec({ runtime: specRuntime, input }) {\n    const { __STORYBOOK_CLIENT_API__, __STORYBOOK_ADDONS_CHANNEL__ } = window;\n\n    if (!__STORYBOOK_CLIENT_API__ || !__STORYBOOK_ADDONS_CHANNEL__) {\n      throw new Error(\n        `Chromatic requires Storybook version at least 3.4. Please update your storybook!`\n      );\n    }\n\n    if (specRuntime !== runtime) {\n      throw new Error(`Storybook plugin cannot handle ${specRuntime} specs`);\n    }\n\n    const { kind, name } = input;\n    __STORYBOOK_ADDONS_CHANNEL__.emit('setCurrentStory', { kind, story: name });\n\n    // If the story has rendered with an error, SB does not return any kind of error\n    // (we will fix this...) However, in the meantime, you can pick this up via a class on the body\n    if (document.body.classList.contains('sb-show-errordisplay')) {\n      const message = document.getElementById('error-message').textContent;\n      const stack = document.getElementById('error-stack').textContent;\n      const error = new Error(message);\n      error.stack = stack;\n      throw error;\n    }\n\n    return document.getElementById('root');\n  },\n  specs() {\n    const { __STORYBOOK_CLIENT_API__, __STORYBOOK_ADDONS_CHANNEL__ } = window;\n\n    if (!__STORYBOOK_CLIENT_API__ || !__STORYBOOK_ADDONS_CHANNEL__) {\n      throw new Error(\n        `Chromatic requires Storybook version at least 3.4. Please update your storybook!`\n      );\n    }\n\n    return __STORYBOOK_CLIENT_API__\n      .getStorybook()\n      .map(({ kind, stories }) =>\n        stories.map(({ name }) => ({\n          name,\n          component: {\n            name: kind,\n            displayName: kind.split('/').slice(-1)[0],\n          },\n          runtime,\n          input: JSON.stringify({\n            kind,\n            name,\n          }),\n        }))\n      )\n      .reduce((a, b) => [...a, ...b], []); // flatten\n  },\n});\n"]}