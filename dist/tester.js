module.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="dist",n(n.s=42)}([function(t,e){t.exports=require("@babel/runtime/regenerator")},function(t,e){t.exports=require("@babel/runtime/helpers/asyncToGenerator")},function(t,e){t.exports=require("@babel/runtime/helpers/toConsumableArray")},function(t,e){t.exports=require("debug")},function(t,e){t.exports=require("@babel/runtime/helpers/classCallCheck")},function(t,e){t.exports=require("path")},function(t,e){t.exports=require("@babel/runtime/helpers/possibleConstructorReturn")},function(t,e){t.exports=require("@babel/runtime/helpers/getPrototypeOf")},function(t,e){t.exports=require("@babel/runtime/helpers/inherits")},function(t,e){t.exports=require("url")},function(t,e){t.exports=require("@babel/runtime/helpers/createClass")},function(t,e){t.exports=require("@babel/runtime/helpers/objectSpread")},function(t,e){t.exports=require("child_process")},function(t,e){t.exports=require("pino")},function(t,e){t.exports=require("denodeify")},function(t,e){t.exports=require("@babel/runtime/helpers/slicedToArray")},function(t,e){t.exports=require("node-fetch")},function(t,e){t.exports=require("jsonfile")},function(t){t.exports={a:"storybook-chromatic",b:"2.2.2"}},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("minimatch")},function(t,e){t.exports=require("semver")},function(t,e){t.exports=require("jsdom")},function(t,e){t.exports=require("@babel/runtime/helpers/taggedTemplateLiteral")},function(t,e){t.exports=require("fake-tag")},function(t,e){t.exports=require("node-ask")},function(t,e){t.exports=require("tree-kill")},function(t,e){t.exports=require("env-ci")},function(t,e){t.exports=require("uuid")},function(t,e){t.exports=require("tmp")},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return getStorybookInfo});var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(15),_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__),require2=eval("require"),findPackageVersion=function(t){try{return require2("".concat(t,"/package.json")).version}catch(t){return}},findInstalledAddons=function(t){var e=t.supportedAddons,n=t.viewLayer,r=t.storybookVersion;return e.map(function(t){var e="@storybook/addon-".concat(t),o=findPackageVersion(e);if(o){if(o!==r){var a="".concat(e,"@").concat(o),i="@storybook/".concat(n,"@").concat(r);console.warn("Version number for ".concat(a," does not match ").concat(i))}return{name:t,packageName:e,packageVersion:o}}}).filter(Boolean)};function getStorybookInfo(){var t,e,n=["react","vue","angular","html","polymer","ember","marko","mithril","riot","svelte","preact","rax"],r=["a11y","actions","backgrounds","centered","contexts","cssresources","design-assets","docs","events","google-analytics","graphql","info","jest","knobs","links","notes","ondevice-actions","ondevice-backgrounds","ondevice-knobs","ondevice-notes","options","queryparams","storyshots","storysource","viewport"],o=process.env.CHROMATIC_STORYBOOK_VERSION;if(o){var a=o.split("@"),i=_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(a,2);if(t=i[0],!(e=i[1])||!t)throw new Error('CHROMATIC_STORYBOOK_VERSION misspecified -- use "viewLayer@version"');if(!n.includes(t))throw new Error("'".concat(t,"' is not a supported view layer. Use one of: ").concat(n.join(", ")));return{storybookVersion:e,viewLayer:t,addons:findInstalledAddons({supportedAddons:r,viewLayer:t,storybookVersion:e})}}for(;n.length>0;)if(t=n.shift(),e=findPackageVersion("@storybook/".concat(t)))return{storybookVersion:e,viewLayer:t,addons:findInstalledAddons({supportedAddons:r,viewLayer:t,storybookVersion:e})};throw new Error("Couldn't discover Storybook version. Try upgrading the storybook-chromatic package.")}},function(t,e){t.exports=require("https")},function(t,e){t.exports=require("@chromaui/localtunnel")},function(t,e){t.exports=require("async-retry")},function(t,e,n){const r=n(13),o=n(40).default;t.exports={__esModule:!0,default:{...r.stdSerializers,err:o}}},function(t,e){t.exports=require("node-loggly-bulk")},function(t,e){t.exports=require("util")},function(t,e){t.exports=require("strip-color")},function(t,e){t.exports=require("progress-stream")},function(t,e){t.exports=require("progress")},function(t,e,n){const r=n(13),o=n(41).default;t.exports={__esModule:!0,default:t=>{const{envPairs:e,...n}=r.stdSerializers.err(t);return{...n,...t.response&&{response:o(t.response)}}}}},function(t,e){t.exports={__esModule:!0,default:function({status:t,statusText:e,headers:n,url:r,_raw:o}){return{status:t,statusText:e,headers:n,url:r,_raw:o.toString()}}}},function(t,e,n){"use strict";n.r(e);var r=n(11),o=n.n(r),a=n(2),i=n.n(a),c=n(0),s=n.n(c),u=n(1),p=n.n(u),l=n(14),d=n.n(l),f=n(25),m=n(3),h=n.n(m),b=n(26),v=n.n(b),y=n(27),w=n.n(y),g=n(28),x=n(9),k=n(20),_=n.n(k),C=n(29),E=n(21),O=n(6),S=n.n(O),T=n(7),A=n.n(T),R=n(8),I=n.n(R),P=n(4),B=n.n(P),U=n(10),j=n.n(U),N=n(22);function L(t){Object.defineProperty(t.window,"matchMedia",{value:function(){return{matches:!0,addListener:function(){},removeListener:function(){}}},writable:!0});var e=function(){function t(){B()(this,t),this.store={}}return j()(t,[{key:"getItem",value:function(t){return this.store[t]}},{key:"removeItem",value:function(t){delete this.store[t]}},{key:"setItem",value:function(t,e){this.store[t]=e.toString()}},{key:"clear",value:function(){this.store={}}}]),t}();Object.defineProperty(t.window,"localStorage",{value:new e,writable:!0});var n=function(){function t(){B()(this,t)}return j()(t,[{key:"addEventListener",value:function(){}},{key:"removeEventLister",value:function(){}},{key:"postMessage",value:function(){}},{key:"terminate",value:function(){}}]),t}();function r(){}Object.defineProperty(t.window,"Worker",{value:n,writable:!0}),Object.defineProperty(t.window,"crypto",{value:{getRandomValues:function(){return 0}},writable:!0}),Object.defineProperty(t.window.navigator,"mimeTypes",{value:function(){return[]},writable:!0}),Object.defineProperty(t.window.URL,"createObjectURL",{value:function(){}}),Object.defineProperty(t.window.URL,"revokeObjectURL",{value:function(){}}),r.prototype={observe:function(){return[]},takeRecords:function(){return[]},disconnect:function(){}},Object.defineProperty(t.window,"MutationObserver",{value:r,writable:!0});var o=function(){function t(){B()(this,t)}return j()(t,[{key:"resolvedOptions",value:function(){return{}}}],[{key:"supportedLocalesOf",value:function(){return[]}}]),t}(),a=function(t){function e(){return B()(this,e),S()(this,A()(e).apply(this,arguments))}return I()(e,t),j()(e,[{key:"format",value:function(){return""}},{key:"formatToParts",value:function(){return[]}}]),e}(o),i=function(t){function e(){return B()(this,e),S()(this,A()(e).apply(this,arguments))}return I()(e,t),j()(e,[{key:"compare",value:function(){return 0}}]),e}(o),c=function(t){function e(){return B()(this,e),S()(this,A()(e).apply(this,arguments))}return I()(e,t),j()(e,[{key:"select",value:function(){return""}}]),e}(o),s=function(t){function e(){return B()(this,e),S()(this,A()(e).apply(this,arguments))}return I()(e,t),e}(a),u=function(t){function e(){return B()(this,e),S()(this,A()(e).apply(this,arguments))}return I()(e,t),e}(a),p=function(t){function e(){return B()(this,e),S()(this,A()(e).apply(this,arguments))}return I()(e,t),e}(a),l=function(t){function e(){return B()(this,e),S()(this,A()(e).apply(this,arguments))}return I()(e,t),e}(a);Object.defineProperty(t.window,"Intl",{value:{Collator:i,DateTimeFormat:s,ListFormat:u,NumberFormat:p,PluralRules:c,RelativeTimeFormat:l},writable:!0});var d,f={};Object.defineProperty(t.window,"customElements",{value:{define:function(t,e){f[t]=f[t]||{resolvers:[]},f[t].constructor=e,f[t].resolvers.forEach(function(t){return t()})},get:function(t){return f[t]&&f[t].constructor},upgrade:function(){},whenDefined:function(t){return new Promise(function(e){f[t]=f[t]||{resolvers:[]},f[t].constructor?e():f[t].resolvers.push(e)})}},writable:!1}),(d=t.window).HTMLCanvasElement.prototype.getContext=function(){return{fillRect:function(){return{}},clearRect:function(){return{}},getImageData:function(t,e,n,r){return{data:new Array(n*r*4)}},putImageData:function(){return{}},createImageData:function(){return[]},setTransform:function(){return{}},drawImage:function(){return{}},save:function(){return{}},fillText:function(){return{}},restore:function(){return{}},beginPath:function(){return{}},moveTo:function(){return{}},lineTo:function(){return{}},closePath:function(){return{}},stroke:function(){return{}},translate:function(){return{}},scale:function(){return{}},rotate:function(){return{}},arc:function(){return{}},fill:function(){return{}},measureText:function(){return{width:0}},transform:function(){return{}},rect:function(){return{}},clip:function(){return{}}}},d.HTMLCanvasElement.prototype.toDataURL=function(){return""}}function q(t){return D.apply(this,arguments)}function D(){return(D=p()(s.a.mark(function t(e){var n,r,o,a,i,c,u,p,l,d=arguments;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:{},r=n.verbose,o=void 0!==r&&r,a=n.names,i=a.product,c=a.packageName,u=[],p=new N.VirtualConsole,Object.keys(console).forEach(function(t){p.on(t,function(e){return u.push({logType:t,log:e})})}),p.on("jsdomError",function(t){return u.push({logType:"error",log:t})}),o&&p.sendTo(console),t.next=8,N.JSDOM.fromURL(e,{userAgent:"Chromatic",runScripts:"dangerously",resources:"usable",virtualConsole:p,pretendToBeVisual:!0});case 8:return L(l=t.sent),t.abrupt("return",new Promise(function(t,n){return l.window.document.addEventListener("DOMContentLoaded",function(){try{var r="=========================";if(!l.window.__chromaticRuntimeSpecs__)throw console.error("Didn't find ".concat(i," addon in your Storybook.\n        \nDid you add it with `import '").concat(c,"'` in your `.storybook/config.js`?\n\nRead more: http://docs.chromaticqa.com")),!o&&u.length&&(console.error("Your app's output:\n".concat(r,"\n")),u.forEach(function(t){var e=t.logType,n=t.log;return console[e](n)}),console.error("\n".concat(r,"\n"))),new Error("Didn't find 'window.__chromaticRuntimeSpecs__' at ".concat(e,"."));u.find(function(t){return"error"===t.logType})&&(console.error("\nYour app logged the following to the error console:\n".concat(r)),u.filter(function(t){return"error"===t.logType}).forEach(function(t){var e=t.logType,n=t.log;return console[e](n)}),console.error("\n".concat(r,"\nThis may lead to some stories not working right or getting detected by Chromatic")+"\nWe suggest you fix the errors, but we will continue anyway..\n"));var a=l.window.__chromaticRuntimeSpecs__();l.window.close(),t(a)}catch(t){l.window.close(),n(t)}})}));case 11:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}var M=n(30),V=n(12),H=n(31),W=n.n(H),G=n(16),$=n.n(G),Q=n(5),F=n.n(Q),Y=1e3,z=3e5,K=new W.a.Agent({rejectUnauthorized:!1});function J(t){return X.apply(this,arguments)}function X(){return(X=p()(s.a.mark(function t(e){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,$()(e,{agent:e.startsWith("https:")?K:void 0});case 3:return t.abrupt("return",!0);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",!1);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))).apply(this,arguments)}function Z(t,e){return tt.apply(this,arguments)}function tt(){return(tt=p()(s.a.mark(function t(e,n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=Date.now()+z,t.abrupt("return",new Promise(function(t,o){var a=!1;function i(){return c.apply(this,arguments)}function c(){return(c=p()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Date.now()>r)){e.next=4;break}return a=!0,o(new Error("No server responding at ".concat(n," within ").concat(z/1e3," seconds."))),e.abrupt("return");case 4:return e.next=6,J(n);case 6:if(!e.sent){e.next=10;break}return a=!0,t(),e.abrupt("return");case 10:setTimeout(i,Y);case 11:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}if(i(),e){var u="";e.stderr.on("data",function(t){u+=t.toString()}),e.stdout.on("data",function(t){u+=t.toString()}),e.on("close",function(){a||o(new Error("Script failed to start: ".concat(u,"\n")))})}}));case 2:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function et(t){return nt.apply(this,arguments)}function nt(){return(nt=p()(s.a.mark(function t(e){var n,r,a,c,u,p,l,d,f,m,h,b;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.scriptName,r=e.commandName,a=e.args,c=void 0===a?[]:a,u=e.url,p=e.inheritStdio,l=void 0!==p&&p,d=o()({},process.env,{NODE_ENV:"development",BROWSER:"none"}),!n){t.next=13;break}return t.next=5,J(u);case 5:if(!t.sent){t.next=7;break}return t.abrupt("return",null);case 7:m=process.env.npm_execpath,h="string"==typeof m&&/\.m?js/.test(F.a.extname(m)),b=h?process.execPath:m||"npm",f=Object(V.spawn)(b,[].concat(i()(h?[m]:[]),["run",n],i()(c)),o()({env:d},l&&{stdio:"inherit"})),t.next=16;break;case 13:if(r){t.next=15;break}throw new Error("You must pass commandName or scriptName");case 15:f=Object(V.spawn)(r,{env:d,shell:!0});case 16:if(!u){t.next=19;break}return t.next=19,Z(f,u);case 19:return t.abrupt("return",f);case 20:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}var rt=n(32),ot=n.n(rt),at=h()("storybook-chromatic:tester:tunnel");function it(t){return ct.apply(this,arguments)}function ct(){return(ct=p()(s.a.mark(function t(e){var n,r,o,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.tunnelUrl,r=e.port,o=e.https,r){t.next=3;break}throw new Error("Need to pass a port into `openTunnel`");case 3:return t.next=5,d()(ot.a)(r,{local_host:"localhost",host:n,https:!!o,cert:o&&o.cert,key:o&&o.key,ca:o&&o.ca});case 5:return(a=t.sent).on("url",function(t){return at("Got tunnel url: %s",t)}),a.on("request",function(t){return at("Got request: %O",t)}),a.tunnel_cluster.on("error",function(t){return at("Got tunnel cluster error: %O",t)}),t.abrupt("return",a);case 10:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}var st=n(17);function ut(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.command,n=t.appDir,r=void 0===n?process.cwd():n,o=Object(st.readFileSync)(F.a.resolve(r,"./package.json"));return Object.values(o.scripts||{}).find(function(t){return t.match(e)})}function pt(t,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).appDir,r=void 0===n?process.cwd():n,o=F.a.resolve(r,"./package.json"),a=Object(st.readFileSync)(o);if(a[t])throw new Error("Script named '".concat(t,"' already exists in package.json"));a.scripts||(a.scripts={}),a.scripts[t]=e,Object(st.writeFileSync)(o,a,{spaces:2})}var lt=n(13),dt=n.n(lt),ft=n(33),mt=n.n(ft),ht=n(34),bt=n.n(ht);class vt extends Error{constructor(t,e,...n){super(...n),Error.captureStackTrace&&Error.captureStackTrace(this,vt),this.response=t,this.message=e||`HTTPClient Failed to fetch ${t.url}, got ${t.status}/${t.statusText}`}}class yt{constructor(t={}){const{log:e=dt()({name:"HTTPClient",serializers:bt.a}),retries:n=0,headers:r={}}=t;this.log=e,this.retries=n,this.headers=r}async fetch(t,e={},{retries:n,noLogErrorBody:r=!1}={}){return mt()(async()=>{const n=await $()(t,{...e,headers:{...this.headers,...e.headers}});if(!n.ok){const t=new vt(n);if(!r){const e=await n.text();this.log.warn({body:e},t.message)}throw t}return n},{retries:void 0!==n?n:this.retries,onRetry:e=>{this.log.warn({url:t,err:e},"Retrying fetch")}})}async fetchBuffer(t,e){return(await this.fetch(t,e)).buffer()}static async fetch(t,e={},n={}){return new yt(n).fetch(t,e)}static async fetchBuffer(t,e={},n={}){return new yt(n).fetchBuffer(t,e)}}class wt{constructor({uri:t,headers:e,retries:n}){if(!t)throw new Error("Option `uri` required.");this.uri=t,this.headers=e,this.retries=n,this.client=new yt}async runQuery(t,e){const n=await this.client.fetch(this.uri,{headers:{...this.headers,"Content-Type":"application/json"},method:"post",body:JSON.stringify({query:t,variables:e})},{retries:this.retries}),{data:r,errors:o}=await n.json();if(o)throw o;return r}static async runQuery(t,e,n){return new wt(t).runQuery(e,n)}}var gt=n(15),xt=n.n(gt),kt=n(23),_t=n.n(kt),Ct=n(24),Et=n.n(Ct);function Ot(){var t=_t()(["\n  query TesterHasBuildsWithCommitsQuery($commits: [String!]!) {\n    app {\n      hasBuildsWithCommits(commits: $commits)\n    }\n  }\n"]);return Ot=function(){return t},t}function St(){var t=_t()(["\n  query TesterFirstCommittedAtQuery($branch: String!) {\n    app {\n      firstBuild(sortByCommittedAt: true) {\n        committedAt\n      }\n      lastBuild(branch: $branch, sortByCommittedAt: true) {\n        commit\n        committedAt\n      }\n    }\n  }\n"]);return St=function(){return t},t}var Tt=h()("storybook-chromatic:tester:git");function At(t){return Rt.apply(this,arguments)}function Rt(){return(Rt=p()(s.a.mark(function t(e){var n,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.abrupt("return",Object(V.execSync)("".concat(e," 2>&1")).toString().trim());case 4:if(t.prev=4,t.t0=t.catch(0),n=t.t0.message,!(r=void 0===n?"":n).match("Not a git repository")){t.next=9;break}throw new Error("Unable to execute git command '".concat(e,"'.\n\nChromatic only works in git projects.\nContact us at support@hichroma.com if you need to use Chromatic outside of one.\n"));case 9:if(!r.match("does not have any commits yet")){t.next=11;break}throw new Error("Unable to execute git command '".concat(e,"'.\n\nChromatic requires that you have created a commit before it can be run.\n"));case 11:throw t.t0;case 12:case"end":return t.stop()}},t,this,[[0,4]])}))).apply(this,arguments)}var It=20,Pt=Et()(St()),Bt=Et()(Ot());function Ut(){return jt.apply(this,arguments)}function jt(){return(jt=p()(s.a.mark(function t(){var e,n,r,o,a,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,At('git log -n 1 --format="%H,%ct,%ce,%cn"');case 2:return e=t.sent.split(","),n=xt()(e,4),r=n[0],o=n[1],a=n[2],i=n[3],t.abrupt("return",{commit:r,committedAt:1e3*o,committerEmail:a,committerName:i});case 9:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function Nt(){return Lt.apply(this,arguments)}function Lt(){return(Lt=p()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",At("git rev-parse --abbrev-ref HEAD"));case 1:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function qt(t){return Dt.apply(this,arguments)}function Dt(){return(Dt=p()(s.a.mark(function t(e){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,At('git cat-file -e "'.concat(e,'^{commit}"'));case 3:return t.abrupt("return",!0);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",!1);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))).apply(this,arguments)}function Mt(t){return t.map(function(t){return t.trim()}).join(" ")}function Vt(t,e){return Ht.apply(this,arguments)}function Ht(){return(Ht=p()(s.a.mark(function t(e,n){var r,o,a,i,c;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.firstCommittedAtSeconds,o=n.commitsWithBuilds,a=n.commitsWithoutBuilds,i="git rev-list HEAD       ".concat(r?"--since ".concat(r):"","       -n ").concat(e+a.length," --not ").concat(Mt(o)),Tt("running ".concat(i)),t.next=5,At(i);case 5:return t.t0=function(t){return!!t},c=t.sent.split("\n").filter(t.t0),Tt("command output: ".concat(c)),t.abrupt("return",c.filter(function(t){return!o.includes(t)}).filter(function(t){return!a.includes(t)}).slice(0,e));case 9:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function Wt(t){return Gt.apply(this,arguments)}function Gt(){return(Gt=p()(s.a.mark(function t(e){var n,r,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e.length){t.next=2;break}return t.abrupt("return",e);case 2:return n=e.map(function(t){return'"'.concat(t,'^@"')}),r="git rev-list ".concat(Mt(e)," --not ").concat(Mt(n)),Tt("running ".concat(r)),t.next=7,At(r);case 7:return t.t0=function(t){return!!t},o=t.sent.split("\n").filter(t.t0),Tt("command output: ".concat(o)),t.abrupt("return",o);case 11:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function $t(t,e,n){return Qt.apply(this,arguments)}function Qt(){return(Qt=p()(s.a.mark(function t(e,n,r){var o,a,c,u,p,l,d;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.firstCommittedAtSeconds,a=r.commitsWithBuilds,c=r.commitsWithoutBuilds,Tt("step: checking ".concat(n," up to ").concat(o)),Tt("step: commitsWithBuilds: ".concat(a)),Tt("step: commitsWithoutBuilds: ".concat(c)),t.next=6,Vt(n,{firstCommittedAtSeconds:o,commitsWithBuilds:a,commitsWithoutBuilds:c});case 6:if(u=t.sent,Tt("step: candidateCommits: ".concat(u)),0!==u.length){t.next=11;break}return Tt("step: no candidateCommits; we are done"),t.abrupt("return",a);case 11:return t.next=13,e.runQuery(Bt,{commits:u});case 13:return p=t.sent,l=p.app.hasBuildsWithCommits,Tt("step: newCommitsWithBuilds: ".concat(l)),d=u.filter(function(t){return!l.find(function(e){return e===t})}),t.abrupt("return",$t(e,2*n,{firstCommittedAtSeconds:o,commitsWithBuilds:[].concat(i()(a),i()(l)),commitsWithoutBuilds:[].concat(i()(c),i()(d))}));case 18:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function Ft(t){return Yt.apply(this,arguments)}function Yt(){return(Yt=p()(s.a.mark(function t(e){var n,r,o,a,c,u,p,l,d,f,m,h,b,v=arguments;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=v.length>1&&void 0!==v[1]?v[1]:{},r=n.branch,o=n.ignoreLastBuildOnBranch,a=void 0!==o&&o,t.next=3,Ut();case 3:return c=t.sent,u=c.committedAt,t.next=7,e.runQuery(Pt,{branch:r});case 7:if(p=t.sent,l=p.app,d=l.firstBuild,f=l.lastBuild,Tt("App firstBuild: ".concat(d,", lastBuild: ").concat(f)),d){t.next=15;break}return Tt("App has no builds, returning []"),t.abrupt("return",[]);case 15:if(m=[],h=[],!("HEAD"!==r&&!a&&f&&f.committedAt<=u)){t.next=26;break}return t.next=20,qt(f.commit);case 20:if(!t.sent){t.next=24;break}m.push(f.commit),t.next=26;break;case 24:Tt("Last build commit not in index, blindly appending to baselines"),h.push(f.commit);case 26:return t.next=28,$t(e,It,{firstCommittedAtSeconds:d.committedAt&&d.committedAt/1e3,commitsWithBuilds:m,commitsWithoutBuilds:[]});case 28:return b=t.sent,Tt("Final commitsWithBuilds: ".concat(b)),t.t0=[],t.t1=h,t.t2=i.a,t.next=35,Wt(b);case 35:return t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.abrupt("return",t.t0.concat.call(t.t0,t.t1,t.t4));case 38:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}var zt=n(18),Kt=process.env,Jt=(Kt.CHROMATIC_SERVER_PORT,Kt.CHROMATIC_INDEX_URL),Xt=void 0===Jt?"https://index.chromaticqa.com":Jt,Zt=Kt.CHROMATIC_TUNNEL_URL,te=void 0===Zt?"https://tunnel.chromaticqa.com":Zt,ee=(Kt.CHROMATIC_CREATE_TUNNEL,Kt.CHROMATIC_APP_CODE,Kt.CHROMA_APP_CODE,Kt.LOGGLY_CUSTOMER_TOKEN),ne=void 0===ee?"b5e26204-cdc5-4c78-a9cc-c69eb7fabad3":ee,re=n(35),oe=n.n(re),ae=n(36),ie=n(37),ce=n.n(ie);function se(t){var e=t.sessionId;if(!process.env.DISABLE_LOGGING){var n=oe.a.createClient({token:ne,subdomain:"hichroma",tags:["storybook-chromatic"],json:!0}),r=!!process.env.DEBUG;h.a.enable("storybook-chromatic:*,localtunnel:*"),h.a.log=function(){var t=ae.format.apply(void 0,arguments);n.log({sessionId:e,msg:ce()(t)}),r&&process.stderr.write("".concat(t,"\n"))}}}var ue=n(19),pe=n(38),le=n.n(pe),de=n(39),fe=n.n(de),me=5,he=h()("storybook-chromatic:tester:upload"),be="\n  mutation TesterGetUploadUrlsMutation($paths: [String!]!) {\n    getUploadUrls(paths: $paths) {\n      domain\n      urls {\n        path\n        url\n        contentType\n      }\n    }\n  }\n";function ve(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";return Object(ue.readdirSync)(Object(Q.join)(t,e)).map(function(t){return Object(Q.join)(e,t)}).map(function(e){var n=Object(ue.statSync)(Object(Q.join)(t,e));return n.isDirectory()?ve(t,e):[{pathname:e,contentLength:n.size}]}).reduce(function(t,e){return[].concat(i()(t),i()(e))},[])}function ye(t){return we.apply(this,arguments)}function we(){return(we=p()(s.a.mark(function t(e){var n,r,o,a,i,c,u,l,d,f;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.client,r=e.dirname,he("uploading '".concat(r,"' to s3")),o=ve(r),t.next=5,n.runQuery(be,{paths:o.map(function(t){return t.pathname})});case 5:return a=t.sent,i=a.getUploadUrls,c=i.domain,u=i.urls,l=o.map(function(t){return t.contentLength}).reduce(function(t,e){return t+e},0),d=new fe.a("uploading [:bar] :rate/bps :percent :etas",{width:20,total:l}),f=[],u.forEach(function(t){var e=t.path,n=t.url,a=t.contentType,i=Object(Q.join)(r,e);he("uploading '".concat(i,"' to '").concat(n,"' with content type '").concat(a,"'"));var c=le()();c.on("progress",function(t){var e=t.delta;return d.tick(e)});var u=o.find(function(t){return t.pathname===e}).contentLength;f.push(p()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,yt.fetch(n,{method:"PUT",body:Object(ue.createReadStream)(i).pipe(c),headers:{"content-type":a,"content-length":u}},{retries:me});case 2:if((r=t.sent).ok){t.next=6;break}throw he("Uploading '".concat(e,"' failed: %O"),r),new Error("Failed to upload ".concat(e));case 6:case"end":return t.stop()}},t,this)}))())}),t.next=15,Promise.all(f);case 15:return t.abrupt("return",new x.URL("/iframe.html",c).toString());case 16:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}n.d(e,"default",function(){return We});var ge,xe,ke=1e3,_e=[/^GERRIT/,/^TRAVIS/],Ce={"--ci":"4.0.0","--loglevel":"5.1.0"},Ee="storybook-chromatic"===zt.a?{product:"Chromatic",packageName:"storybook-chromatic",script:"chromatic",command:"chromatic test",envVar:"CHROMATIC_APP_CODE",url:"https://www.chromaticqa.com"}:{product:"Chroma",packageName:"storybook-chroma",script:"chroma",command:"chroma publish",envVar:"CHROMA_APP_CODE",url:"https://www.chromaui.com"},Oe=(ge=Ee.product,function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.noPrefix,r=void 0!==n&&n,o=e.level,a=void 0===o?"log":o;"true"!==process.env.DISABLE_LOGGING&&(r?console[a](t):console[a]("".concat(ge,": ").concat(t)))}),Se="\n  mutation TesterCreateAppTokenMutation($appCode: String!) {\n    createAppToken(code: $appCode)\n  }\n",Te="\n  mutation TesterCreateBuildMutation($input: CreateBuildInput!, $isolatorUrl: String!) {\n    createBuild(input: $input, isolatorUrl: $isolatorUrl) {\n      id\n      number\n      specCount\n      snapshotCount\n      componentCount\n      webUrl\n      app {\n        account {\n          features { \n            diffs\n          }\n        }\n      }\n    }\n  }\n",Ae="\n  mutation TesterSkipBuildMutation($appId: ObjID, $commit: String!) {\n    skipBuild(appId: $appId, commit: $commit)\n  }\n",Re="\n  query TesterBuildQuery($buildNumber: Int!) {\n    app {\n      build(number: $buildNumber) {\n        id\n        status\n        autoAcceptChanges\n        inProgressCount: snapshotCount(statuses: [SNAPSHOT_IN_PROGRESS])\n        snapshotCount\n        changeCount\n        errorCount: snapshotCount(statuses: [SNAPSHOT_CAPTURE_ERROR])\n      }\n    }\n  }\n",Ie=h()("storybook-chromatic:tester");function Pe(t,e,n){var r=1===t?e:"".concat(e,"s");return r.endsWith("ys")&&(r=r.replace(/ys$/,"ies")),n?r:"".concat(t," ").concat(r)}function Be(t,e,n){return Ue.apply(this,arguments)}function Ue(){return(Ue=p()(s.a.mark(function t(e,n,r){var o,a,i,c,u,p,l,d;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.diffs,t.next=3,e.runQuery(Re,n);case 3:if(a=t.sent,i=a.app.build,Ie("build:".concat(JSON.stringify(i))),c=i.status,u=i.inProgressCount,p=i.snapshotCount,l=i.changeCount,d=i.errorCount,"BUILD_IN_PROGRESS"!==c){t.next=12;break}return u!==xe&&(xe=u,Oe(o?"".concat(u,"/").concat(Pe(p,"snapshot")," remain to test. ")+"(".concat(Pe(l,"change"),", ").concat(Pe(d,"error"),")"):"".concat(u,"/").concat(Pe(p,"story")," remain to publish. "))),t.next=11,new Promise(function(t){return setTimeout(t,ke)});case 11:return t.abrupt("return",Be(e,n,{diffs:o}));case 12:return t.abrupt("return",i);case 13:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function je(t){return Ne.apply(this,arguments)}function Ne(){return(Ne=p()(s.a.mark(function t(e){var n,r,o,a,i,c,u,p,l,d,f,m,h,b,v,y;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.inputFromCI,t.next=3,Ut();case 3:return r=t.sent,o=r.commit,a=r.committedAt,i=r.committerEmail,c=r.committerName,t.next=10,Nt();case 10:if(u=t.sent,p=process.env,l=p.TRAVIS_EVENT_TYPE,d=p.TRAVIS_PULL_REQUEST_SLUG,f=p.TRAVIS_REPO_SLUG,m=p.TRAVIS_PULL_REQUEST_SHA,h=p.TRAVIS_PULL_REQUEST_BRANCH,(b="pull_request"===l)&&d===f&&Oe("WARNING: Running Chromatic on a Travis PR build from an internal branch.\n\nIt is recommended to run Chromatic on the push builds from Travis where possible.\nWe advise turning on push builds and disabling Chromatic for internal PR builds.\nRead more: https://docs.chromaticqa.com/setup_ci#travis\n",{noPrefix:!0,level:"warn"}),!b){t.next=19;break}if(u=h,(o=m)&&u){t.next=19;break}throw new Error("`TRAVIS_EVENT_TYPE` environment variable set to 'pull_request', \nbut `TRAVIS_PULL_REQUEST_SHA` and `TRAVIS_PULL_REQUEST_BRANCH` are not both set.\n\nRead more here: https://docs.chromaticqa.com/setup_ci#travis");case 19:return"HEAD"!==u&&u||(v=w()(),"HEAD"!==(u=v.branch)&&u||(u=process.env.HEAD||process.env.GERRIT_BRANCH||process.env.CI_BRANCH||u||"HEAD")),y=n||!!process.env.CI||!!process.env.REPOSITORY_URL,Ie("git info: ".concat(JSON.stringify({commit:o,committedAt:a,committerEmail:i,committerName:c,branch:u,isTravisPrBuild:b,fromCI:y}))),t.abrupt("return",{commit:o,committedAt:a,committerEmail:i,committerName:c,branch:u,isTravisPrBuild:b,fromCI:y});case 23:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function Le(t){return qe.apply(this,arguments)}function qe(){return(qe=p()(s.a.mark(function t(e){var n,r,a,c,u,l,f,m,h,b,y,w,g,k,_,O,S,T,A,R,I,P,B,U,j,N,L;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.client,r=e.dirname,a=e.noStart,c=e.buildScriptName,u=e.scriptName,l=e.commandName,f=e.https,m=e.url,h=e.createTunnel,b=e.tunnelUrl,y=e.storybookVersion,!r&&!c){t.next=20;break}if(w=r,!c){t.next=13;break}return Oe("Building your Storybook"),g=Object(C.dirSync)({unsafeCleanup:!0,prefix:"".concat(Ee.script,"-")}),w=g.name,Ie("Building Storybook to ".concat(w)),t.next=10,et({scriptName:c,args:["--","-o",w].concat(i()(y&&Object(E.gte)(y,Ce["--loglevel"])?["--loglevel","error"]:[])),inheritStdio:!0});case 10:return k=t.sent,t.next=13,new Promise(function(t,e){k.on("error",e),k.on("close",function(n){n>0&&e(new Error("".concat(c," script exited with code ").concat(n))),t()})});case 13:return Oe("Uploading your built Storybook..."),t.next=16,ye({client:n,dirname:w});case 16:return _=t.sent,Ie("uploading to s3, got ".concat(_)),Oe("Uploaded your build, verifying"),t.abrupt("return",{isolatorUrl:_});case 20:if(a){t.next=29;break}return Oe("Starting Storybook"),t.next=24,et({scriptName:u,commandName:l,url:m,args:u&&y&&Object(E.gte)(y,Ce["--ci"])&&["--","--ci"]});case 24:S=t.sent,O=S&&p()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",d()(v.a)(S.pid,"SIGHUP"));case 1:case"end":return t.stop()}},t,this)})),Oe("Started Storybook at ".concat(m)),t.next=35;break;case 29:if(!m){t.next=35;break}return t.next=32,J(m);case 32:if(t.sent){t.next=34;break}throw new Error("No server responding at ".concat(m," -- make sure you've started it."));case 34:Oe("Detected Storybook at ".concat(m));case 35:if(T=Object(x.parse)(m,!0),A=T.port,R=T.pathname,I=T.query,P=T.hash,h){t.next=38;break}return t.abrupt("return",{cleanup:O,isolatorUrl:m});case 38:return Oe("Opening tunnel to Chromatic capture servers"),t.prev=39,t.next=42,it({tunnelUrl:b,port:A,https:f});case 42:B=t.sent,U=function(){var t=p()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!O){t.next=3;break}return t.next=3,O();case 3:return t.next=5,B.close();case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),Ie("Opened tunnel to ".concat(B.url)),t.next=52;break;case 47:throw t.prev=47,t.t0=t.catch(39),Ie("Got error %O",t.t0),O&&O(),t.t0;case 52:if((j=Object(x.parse)(B.cachedUrl||B.url)).pathname=R,j.query=I,j.hash=P,N=j.format(),!B.cachedUrl){t.next=63;break}return(L=Object(x.parse)(B.url,!0)).query=o()({},L.query,{path:Object(x.format)({pathname:R,query:I})}),L.hash=P,L.search=null,t.abrupt("return",{cleanup:U,isolatorUrl:L.format(),cachedUrl:N});case 63:return t.abrupt("return",{cleanup:U,isolatorUrl:N});case 64:case"end":return t.stop()}},t,this,[[39,47]])}))).apply(this,arguments)}function De(t){return Me.apply(this,arguments)}function Me(){return(Me=p()(s.a.mark(function t(e){var n,r,o,a,i,c,u,p;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.only,r=e.list,o=e.isolatorUrl,a=e.verbose,i=function(){return!0},!n){t.next=8;break}if(c=n.match(/(.*):([^:]*)/)){t.next=6;break}throw new Error('--only argument must provided in the form "componentName:storyName"');case 6:Oe("Running only story '".concat(c[2],"' of component '").concat(c[1],"'")),i=function(t){var e=t.name,n=t.component.name;return _()(e,c[2])&&_()(n,c[1])};case 8:return u=function(t){return t},r&&(Oe("Listing available stories:"),u=function(t){var e=t.name,n=t.component.name;return Oe("".concat(n,":").concat(e)),t}),t.next=12,q(o,{verbose:a,names:Ee});case 12:if(t.t0=u,t.t1=i,0!==(p=t.sent.map(t.t0).filter(t.t1)).length){t.next=17;break}throw new Error("Cannot run a build with no stories. Please add some stories!");case 17:return Oe("Found ".concat(Pe(p.length,"story"))),t.abrupt("return",p);case 19:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function Ve(){return He.apply(this,arguments)}function He(){return(He=p()(s.a.mark(function t(){var e,n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={},Object.keys(process.env).forEach(function(t){_e.find(function(e){return t.match(e)})&&(e[t]=process.env[t])}),n=JSON.stringify(e),Ie("Got environment %s",n),t.abrupt("return",n);case 5:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function We(t){return Ge.apply(this,arguments)}function Ge(){return(Ge=p()(s.a.mark(function t(e){var n,r,a,i,c,u,p,l,d,m,h,b,v,y,w,x,k,_,C,E,O,S,T,A,R,I,P,B,U,j,N,L,q,D,V,H,W,G,$,Q,F,Y,z,K,J,X,Z,tt,et,nt,rt,ot,at,it,ct,st,lt,dt,ft,mt,ht,bt,vt,yt,gt,xt,kt,_t,Ct,Et,Ot,St,Tt,At,Rt,It,Pt;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.appCode,r=e.buildScriptName,a=e.scriptName,i=e.exec,c=e.noStart,u=void 0!==c&&c,p=e.https,l=e.url,d=e.storybookBuildDir,m=e.only,h=e.skip,b=e.list,v=e.fromCI,y=void 0!==v&&v,w=e.autoAcceptChanges,x=void 0!==w&&w,k=e.exitZeroOnChanges,_=void 0!==k&&k,C=e.ignoreLastBuildOnBranch,E=void 0!==C&&C,O=e.preserveMissingSpecs,S=void 0!==O&&O,T=e.verbose,A=void 0!==T&&T,R=e.interactive,I=void 0===R||R,P=e.indexUrl,B=void 0===P?Xt:P,U=e.tunnelUrl,j=void 0===U?te:U,N=e.createTunnel,L=void 0===N||N,q=e.originalArgv,D=void 0!==q&&q,V=e.sessionId,se({sessionId:H=void 0===V?Object(g.v4)():V}),Ie("Creating build with session id: ".concat(H)),Ie("Connecting to index:".concat(B," and ").concat(L?"using tunnel:".concat(j):"not creating a tunnel")),W=new wt({uri:"".concat(B,"/graphql"),headers:{"x-chromatic-session-id":H},retries:3}),n){t.next=7;break}throw new Error("You must provide an app code.\n\nIf you don't have a project yet login to ".concat(Ee.url," and create a new project.\nOr find your code on the manage page of an existing project.\n\nPass your app code with the `").concat(Ee.envVar,"` environment variable or the `--app-code` flag."));case 7:return t.prev=7,t.next=10,W.runQuery(Se,{appCode:n});case 10:G=t.sent,$=G.createAppToken,W.headers=o()({},W.headers,{Authorization:"Bearer ".concat($)}),t.next=20;break;case 15:if(t.prev=15,t.t0=t.catch(7),!(t.t0[0]&&t.t0[0].message&&t.t0[0].message.match("No app with code"))){t.next=19;break}throw new Error("Incorrect app code '".concat(n,"'.\n      \nIf you don't have a project yet login to ").concat(Ee.url," and create a new project.\nOr find your code on the manage page of an existing project."));case 19:throw t.t0;case 20:return t.next=22,je({inputFromCI:y});case 22:if(Q=t.sent,F=Q.commit,Y=Q.committedAt,z=Q.committerEmail,K=Q.committerName,J=Q.branch,X=Q.isTravisPrBuild,Z=Q.fromCI,!h){t.next=37;break}return t.next=33,W.runQuery(Ae,{commit:F});case 33:if(!t.sent){t.next=36;break}return Oe("Build skipped for commit ".concat(F,".")),t.abrupt("return",0);case 36:throw new Error("Failed to skip build.");case 37:if(r||a||i||u){t.next=39;break}throw new Error("Either buildScriptName, scriptName, commandName or noStart is required");case 39:return tt="string"==typeof x?x===J:x,et="string"==typeof _?_===J:_,nt="string"==typeof E?E===J:E,t.next=44,Ft(W,{branch:J,ignoreLastBuildOnBranch:nt});case 44:return rt=t.sent,Ie("Found baselineCommits: ".concat(rt)),ot=Object(M.a)(),at=ot.storybookVersion,it=ot.viewLayer,ct=ot.addons,Ie("Detected package version: ".concat(zt.b,", storybook version: ").concat(at,", view layer: ").concat(it,", addons: ").concat(ct.length?ct.map(function(t){return t.name}).join(", "):"none")),st=5,t.next=51,Le({storybookVersion:at,client:W,dirname:d,noStart:u,buildScriptName:r,scriptName:a,commandName:i,https:p,url:l,createTunnel:L,tunnelUrl:j});case 51:return lt=t.sent,dt=lt.cleanup,ft=lt.isolatorUrl,mt=lt.cachedUrl,Ie("Connecting to ".concat(ft," (cachedUrl ").concat(mt,")")),Oe("Uploading and verifying build (this may take a few minutes depending on your connection)"),t.prev=57,t.next=60,De({only:m,list:b,isolatorUrl:ft,verbose:A});case 60:return ht=t.sent,t.next=63,Ve();case 63:return bt=t.sent,t.next=66,W.runQuery(Te,{input:{cachedUrl:mt,autoAcceptChanges:tt,preserveMissingSpecs:S,branch:J,commit:F,committedAt:Y,baselineCommits:rt,runtimeSpecs:ht,fromCI:Z,isTravisPrBuild:X,packageVersion:zt.b,storybookVersion:at,viewLayer:it,addons:ct,committerEmail:z,committerName:K,environment:bt},isolatorUrl:ft});case 66:return vt=t.sent,yt=vt.createBuild,gt=yt.number,xt=yt.snapshotCount,kt=yt.specCount,_t=yt.componentCount,Ct=yt.webUrl,Et=yt.app.account.features.diffs,Ot="View it online at ".concat(Ct),Oe("Started Build ".concat(gt," ")+"(".concat(Pe(_t,"component"),", ").concat(Pe(kt,"story"),", ").concat(Pe(xt,"snapshot"),").\n\n").concat(Ot,".")),t.next=78,Be(W,{buildNumber:gt},{diffs:Et});case 78:St=t.sent,Tt=St.status,At=St.autoAcceptChanges,Rt=St.changeCount,It=St.errorCount,t.t1=Tt,t.next="BUILD_PASSED"===t.t1?86:"BUILD_ACCEPTED"===t.t1?89:"BUILD_PENDING"===t.t1?89:"BUILD_DENIED"===t.t1?89:"BUILD_FAILED"===t.t1?93:"BUILD_TIMED_OUT"===t.t1?96:"BUILD_ERROR"===t.t1?96:99;break;case 86:return Oe(Et?"Build ".concat(gt," passed! ").concat(Ot,"."):"Build ".concat(gt," published! ").concat(Ot,".")),st=0,t.abrupt("break",100);case 89:return Oe("Build ".concat(gt," has ").concat(Pe(Rt,"change"),". ").concat(Ot,".")),0!==(st=et||At?0:1)&&Oe("Pass --exit-zero-on-changes if you want this command to exit successfully in this case.\n  Alternatively, pass --auto-accept-changes if you want changed builds to pass on this branch.\n  Read more: https://docs.chromaticqa.com/test"),t.abrupt("break",100);case 93:return Oe(Et?"Build ".concat(gt," has ").concat(Pe(It,"error"),". ").concat(Ot,"."):"Build ".concat(gt," was published but we found errors. ").concat(Ot,".")),st=2,t.abrupt("break",100);case 96:return Oe("Build ".concat(gt," has failed to run. Our apologies. Please try again.")),st=3,t.abrupt("break",100);case 99:throw new Error("Unexpected build status: ".concat(Tt));case 100:t.next=111;break;case 102:if(t.prev=102,t.t2=t.catch(57),!(t.t2.length&&t.t2[0]&&t.t2[0].message&&t.t2[0].message.match(/Cannot run a build with no specs./))){t.next=109;break}Oe(t.t2[0].message),st=255,t.next=111;break;case 109:throw Ie("Got error %O",t.t2),t.t2;case 111:if(t.prev=111,!dt){t.next=115;break}return t.next=115,dt();case 115:return t.finish(111);case 116:if(ut({command:Ee.command})||!D||Z||!I){t.next=122;break}return Pt="".concat(Ee.envVar,"=").concat(n," ").concat(Ee.command," ").concat(D.slice(2).join(" ")).replace(/--app-code[= ]\S+/,"").trim(),t.next=120,Object(f.confirm)("\nYou have not added the `".concat(Ee.script,"` script to your `package.json`. Would you like me to do it for you?"));case 120:t.sent?(pt(Ee.script,Pt),Oe("\nAdded script `".concat(Ee.script,"`. You can now run it here or in CI with `npm run ").concat(Ee.script,"` (or `yarn ").concat(Ee.script,"`)\n\nNOTE: I wrote your app code to the `").concat(Ee.envVar,"` environment variable. The app code cannot be used to read story data, it can only be used to create new builds. If you would still prefer not to check it into source control, you can remove it from `package.json` and set it via an environment variable instead."),{noPrefix:!0})):Oe('\nNo problem. You can add it later with:\n{\n  "scripts": {\n    "'.concat(Ee.script,'": "').concat(Pt,'"\n  }\n}'),{noPrefix:!0});case 122:return t.abrupt("return",st);case 123:case"end":return t.stop()}},t,this,[[7,15],[57,102,111,116]])}))).apply(this,arguments)}}]);
//# sourceMappingURL=tester.js.map